Add test case for W [OqF4Pk] line 2.2
Refactor codebase with Z [H05wWY] line 7.2
